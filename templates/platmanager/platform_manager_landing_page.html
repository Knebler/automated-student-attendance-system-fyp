{% extends "layouts/base.html" %}

{% block title %}Landing Page Management - Platform Manager{% endblock %}

{% block content %}
<style>
    .page-header {
        margin-bottom: 2rem;
    }

    .page-header h1 {
        font-size: 2rem;
        color: var(--text-dark);
        margin-bottom: 0.5rem;
    }

    .page-header p {
        color: var(--text-light);
    }

    .tabs {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 2rem;
        border-bottom: 2px solid var(--border-color);
    }

    .tab-button {
        padding: 1rem 2rem;
        border: none;
        background: none;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        color: var(--text-light);
        border-bottom: 3px solid transparent;
        transition: all 0.2s;
    }

    .tab-button:hover {
        color: var(--text-dark);
    }

    .tab-button.active {
        color: var(--primary);
        border-bottom-color: var(--primary);
    }

    .tab-content {
        display: none;
    }

    .tab-content.active {
        display: block;
    }

    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        background: white;
        border: 2px solid var(--border-color);
        border-radius: 12px;
        padding: 1.5rem;
        text-align: center;
    }

    .stat-card h3 {
        font-size: 2rem;
        color: var(--text-dark);
        margin-bottom: 0.5rem;
    }

    .stat-card p {
        color: var(--text-light);
        font-size: 0.9rem;
    }

    .filter-section {
        background: white;
        border: 2px solid var(--border-color);
        border-radius: 12px;
        padding: 1.5rem;
        margin-bottom: 2rem;
    }

    .filter-controls {
        display: flex;
        gap: 1rem;
        flex-wrap: wrap;
        align-items: center;
    }

    .filter-controls select,
    .filter-controls input {
        padding: 0.5rem;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 0.9rem;
    }

    .content-table {
        background: white;
        border: 2px solid var(--border-color);
        border-radius: 12px;
        overflow: hidden;
    }

    .table-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem;
        border-bottom: 2px solid var(--border-color);
    }

    .table-header h2 {
        font-size: 1.25rem;
        color: var(--text-dark);
    }

    table {
        width: 100%;
        border-collapse: collapse;
    }

    thead {
        background-color: var(--primary-light);
    }

    th {
        padding: 1rem;
        text-align: left;
        font-weight: 600;
        color: var(--text-dark);
        border-bottom: 2px solid var(--border-color);
    }

    td {
        padding: 1rem;
        border-bottom: 1px solid var(--border-color);
        color: var(--text-dark);
    }

    tbody tr:hover {
        background-color: var(--primary-light);
    }

    .feature-icon {
        font-size: 2rem;
    }

    .badge {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
    }

    .badge-success {
        background-color: #d1fae5;
        color: #065f46;
    }

    .badge-warning {
        background-color: #fef3c7;
        color: #92400e;
    }

    .badge-info {
        background-color: #dbeafe;
        color: #1e40af;
    }

    .badge-secondary {
        background-color: #f3f4f6;
        color: #4b5563;
    }

    .action-buttons {
        display: flex;
        gap: 0.5rem;
    }

    .btn-icon {
        padding: 0.5rem;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.2s;
        font-size: 0.9rem;
    }

    .btn-edit {
        background-color: #dbeafe;
        color: #1e40af;
    }

    .btn-edit:hover {
        background-color: #bfdbfe;
    }

    .btn-delete {
        background-color: #fee2e2;
        color: #991b1b;
    }

    .btn-delete:hover {
        background-color: #fecaca;
    }

    .btn-toggle {
        background-color: #fef3c7;
        color: #92400e;
    }

    .btn-toggle:hover {
        background-color: #fde68a;
    }

    /* Modal Styles */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        padding: 1rem;
    }

    .modal-overlay.active {
        display: flex;
    }

    .modal-content {
        background-color: white;
        border-radius: 12px;
        padding: 2rem;
        max-width: 800px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
    }

    .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
    }

    .modal-header h2 {
        font-size: 1.5rem;
        color: var(--text-dark);
    }

    .modal-close {
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--text-light);
    }

    .form-group {
        margin-bottom: 1.5rem;
    }

    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        font-weight: 600;
        color: var(--text-dark);
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
        width: 100%;
        padding: 0.75rem;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 0.9rem;
    }

    .form-group textarea {
        min-height: 100px;
        resize: vertical;
    }

    .form-group small {
        display: block;
        margin-top: 0.25rem;
        color: var(--text-light);
        font-size: 0.85rem;
    }

    .checkbox-group {
        display: flex;
        gap: 2rem;
        margin-top: 1rem;
    }

    .checkbox-group label {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: normal;
    }

    .checkbox-group input[type="checkbox"] {
        width: auto;
    }

    .modal-actions {
        display: flex;
        gap: 1rem;
        justify-content: flex-end;
        margin-top: 2rem;
    }

    .empty-state {
        text-align: center;
        padding: 3rem;
        color: var(--text-light);
    }

    .empty-state p {
        font-size: 1.1rem;
        margin-bottom: 1rem;
    }

    @media (max-width: 768px) {
        .tabs {
            overflow-x: auto;
        }

        .tab-button {
            white-space: nowrap;
        }

        .filter-controls {
            flex-direction: column;
            width: 100%;
        }

        .filter-controls select,
        .filter-controls input,
        .filter-controls button {
            width: 100%;
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            font-size: 0.85rem;
        }

        th, td {
            padding: 0.5rem;
        }

        .action-buttons {
            flex-direction: column;
        }
    }
</style>

<div class="page-header">
    <h1>Landing Page & About Us Management</h1>
    <p>Manage all sections of the homepage (index.html) and About Us page</p>
</div>

<!-- Tabs -->
<div class="tabs">
    <button class="tab-button active" onclick="switchTab('hero')">
        üé¨ Hero Slideshow
    </button>
    <button class="tab-button" onclick="switchTab('stats')">
        üìä Statistics
    </button>
    <button class="tab-button" onclick="switchTab('features')">
        ‚ö° Features
    </button>
    <button class="tab-button" onclick="switchTab('about')">
        ‚ÑπÔ∏è About Us
    </button>
    <button class="tab-button" onclick="switchTab('team')">
        üë• Team
    </button>
    <button class="tab-button" onclick="switchTab('values')">
        üíé Values
    </button>
</div>

<!-- Hero Features Tab -->
<div id="hero-tab" class="tab-content active">
    <div class="stats-grid">
        <div class="stat-card">
            <h3>{{ total_hero_features }}</h3>
            <p>Total Hero Items</p>
        </div>
        <div class="stat-card">
            <h3>{{ active_hero_features }}</h3>
            <p>Active Items</p>
        </div>
    </div>

    <div class="filter-section">
        <div class="filter-controls">
            <input type="text" id="heroSearchInput" placeholder="Search hero features..." onkeyup="filterTable('hero')">
            <button class="btn-custom" onclick="openModal('hero', 'add')">
                ‚ûï Add Hero Feature
            </button>
        </div>
    </div>

    <div class="content-table">
        <div class="table-header">
            <h2>Hero Slideshow Items</h2>
        </div>
        
        {% if hero_features %}
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Icon</th>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Order</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="heroTableBody">
                    {% for hf in hero_features %}
                    <tr data-id="{{ hf.hero_feature_id }}" data-title="{{ hf.title.lower() }}">
                        <td class="feature-icon">{{ hf.icon }}</td>
                        <td>
                            <strong>{{ hf.title }}</strong><br>
                            <small style="color: var(--text-light);">{{ hf.summary[:60] }}...</small>
                        </td>
                        <td>{{ hf.description[:80] }}...</td>
                        <td>{{ hf.display_order }}</td>
                        <td>
                            {% if hf.is_active %}
                                <span class="badge badge-success">Active</span>
                            {% else %}
                                <span class="badge badge-warning">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit" onclick="editHeroFeature({{ hf.hero_feature_id }})" title="Edit">‚úèÔ∏è</button>
                                <button class="btn-icon btn-toggle" onclick="toggleStatus('hero', {{ hf.hero_feature_id }}, {{ 'true' if hf.is_active else 'false' }})" title="Toggle">
                                    {% if hf.is_active %}üëÅÔ∏è{% else %}üö´{% endif %}
                                </button>
                                <button class="btn-icon btn-delete" onclick="deleteItem('hero', {{ hf.hero_feature_id }}, '{{ hf.title }}')" title="Delete">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>No hero features found</p>
            <button class="btn-custom" onclick="openModal('hero', 'add')">Add Your First Hero Feature</button>
        </div>
        {% endif %}
    </div>
</div>

<!-- Stats Tab -->
<div id="stats-tab" class="tab-content">
    <div class="stats-grid">
        <div class="stat-card">
            <h3>{{ total_stats }}</h3>
            <p>Total Stats</p>
        </div>
        <div class="stat-card">
            <h3>{{ active_stats }}</h3>
            <p>Active Stats</p>
        </div>
    </div>

    <div class="filter-section">
        <div class="filter-controls">
            <input type="text" id="statsSearchInput" placeholder="Search stats..." onkeyup="filterTable('stats')">
            <button class="btn-custom" onclick="openModal('stats', 'add')">
                ‚ûï Add Stat
            </button>
        </div>
    </div>

    <div class="content-table">
        <div class="table-header">
            <h2>Statistics Section</h2>
        </div>
        
        {% if stats %}
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Value</th>
                        <th>Label</th>
                        <th>Order</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="statsTableBody">
                    {% for stat in stats %}
                    <tr data-id="{{ stat.stat_id }}" data-label="{{ stat.label.lower() }}">
                        <td><strong style="font-size: 1.5rem;">{{ stat.value }}</strong></td>
                        <td>{{ stat.label }}</td>
                        <td>{{ stat.display_order }}</td>
                        <td>
                            {% if stat.is_active %}
                                <span class="badge badge-success">Active</span>
                            {% else %}
                                <span class="badge badge-warning">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit" onclick="editStat({{ stat.stat_id }})" title="Edit">‚úèÔ∏è</button>
                                <button class="btn-icon btn-toggle" onclick="toggleStatus('stats', {{ stat.stat_id }}, {{ 'true' if stat.is_active else 'false' }})" title="Toggle">
                                    {% if stat.is_active %}üëÅÔ∏è{% else %}üö´{% endif %}
                                </button>
                                <button class="btn-icon btn-delete" onclick="deleteItem('stats', {{ stat.stat_id }}, '{{ stat.label }}')" title="Delete">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>No stats found</p>
            <button class="btn-custom" onclick="openModal('stats', 'add')">Add Your First Stat</button>
        </div>
        {% endif %}
    </div>
</div>

<!-- Features Tab -->
<div id="features-tab" class="tab-content">
    <div class="stats-grid">
        <div class="stat-card">
            <h3>{{ total_features }}</h3>
            <p>Total Features</p>
        </div>
        <div class="stat-card">
            <h3>{{ active_features }}</h3>
            <p>Active Features</p>
        </div>
        <div class="stat-card">
            <h3>{{ main_features_count }}</h3>
            <p>Main Features</p>
        </div>
        <div class="stat-card">
            <h3>{{ advanced_features_count }}</h3>
            <p>Advanced Features</p>
        </div>
    </div>

    <div class="filter-section">
        <div class="filter-controls">
            <select id="statusFilter" onchange="filterTable('features')">
                <option value="">All Status</option>
                <option value="active">Active</option>
                <option value="inactive">Inactive</option>
            </select>
            <select id="typeFilter" onchange="filterTable('features')">
                <option value="">All Types</option>
                <option value="main">Main Features</option>
                <option value="advanced">Advanced Features</option>
            </select>
            <input type="text" id="featuresSearchInput" placeholder="Search features..." onkeyup="filterTable('features')">
            <button class="btn-custom" onclick="openModal('features', 'add')">
                ‚ûï Add Feature
            </button>
        </div>
    </div>

    <div class="content-table">
        <div class="table-header">
            <h2>Features Section</h2>
        </div>
        
        {% if features %}
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Icon</th>
                        <th>Title</th>
                        <th>Slug</th>
                        <th>Type</th>
                        <th>Order</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="featuresTableBody">
                    {% for feature in features %}
                    <tr data-id="{{ feature.feature_id }}" 
                        data-status="{{ 'active' if feature.is_active else 'inactive' }}"
                        data-type="{{ 'advanced' if feature.is_advanced else 'main' }}"
                        data-title="{{ feature.title.lower() }}">
                        <td class="feature-icon">{{ feature.icon }}</td>
                        <td>
                            <strong>{{ feature.title }}</strong><br>
                            <small style="color: var(--text-light);">{{ feature.description[:80] }}...</small>
                        </td>
                        <td><code>{{ feature.slug }}</code></td>
                        <td>
                            {% if feature.is_advanced %}
                                <span class="badge badge-info">Advanced</span>
                            {% else %}
                                <span class="badge badge-secondary">Main</span>
                            {% endif %}
                        </td>
                        <td>{{ feature.display_order }}</td>
                        <td>
                            {% if feature.is_active %}
                                <span class="badge badge-success">Active</span>
                            {% else %}
                                <span class="badge badge-warning">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit" onclick="editFeature({{ feature.feature_id }})" title="Edit">‚úèÔ∏è</button>
                                <button class="btn-icon btn-toggle" onclick="toggleStatus('features', {{ feature.feature_id }}, {{ 'true' if feature.is_active else 'false' }})" title="Toggle">
                                    {% if feature.is_active %}üëÅÔ∏è{% else %}üö´{% endif %}
                                </button>
                                <button class="btn-icon btn-delete" onclick="deleteItem('features', {{ feature.feature_id }}, '{{ feature.title }}')" title="Delete">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>No features found</p>
            <button class="btn-custom" onclick="openModal('features', 'add')">Add Your First Feature</button>
        </div>
        {% endif %}
    </div>
</div>

<!-- About Us Tab -->
<div id="about-tab" class="tab-content">
    <h2 style="text-align: center; margin-bottom: 2rem;">About Us Page Content</h2>
    
    <div class="content-table" style="margin-bottom: 2rem;">
        <div class="table-header">
            <h2>Intro Section</h2>
            <button class="btn-custom" onclick="editAboutIntro()">‚úèÔ∏è Edit</button>
        </div>
        <div style="padding: 2rem;">
            {% if about_intro %}
            <h3>{{ about_intro.title }}</h3>
            <p>{{ about_intro.description }}</p>
            {% else %}
            <p style="text-align: center; color: var(--text-light);">No intro content found</p>
            {% endif %}
        </div>
    </div>
    
    <div class="content-table" style="margin-bottom: 2rem;">
        <div class="table-header">
            <h2>Our Story</h2>
            <button class="btn-custom" onclick="editAboutStory()">‚úèÔ∏è Edit</button>
        </div>
        <div style="padding: 2rem;">
            {% if about_story %}
            <h3>{{ about_story.title }}</h3>
            <p>{{ about_story.content }}</p>
            {% else %}
            <p style="text-align: center; color: var(--text-light);">No story content found</p>
            {% endif %}
        </div>
    </div>
    
    <div class="mission-vision-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 2rem;">
        <div class="content-table">
            <div class="table-header">
                <h2>Mission</h2>
                <button class="btn-custom" onclick="editMissionVision('mission')">‚úèÔ∏è Edit</button>
            </div>
            <div style="padding: 2rem;">
                {% set mission = mission_vision|selectattr('type', 'equalto', 'mission')|first %}
                {% if mission %}
                <h3>{{ mission.title }}</h3>
                <p>{{ mission.content }}</p>
                {% else %}
                <p style="text-align: center; color: var(--text-light);">No mission found</p>
                {% endif %}
            </div>
        </div>
        
        <div class="content-table">
            <div class="table-header">
                <h2>Vision</h2>
                <button class="btn-custom" onclick="editMissionVision('vision')">‚úèÔ∏è Edit</button>
            </div>
            <div style="padding: 2rem;">
                {% set vision = mission_vision|selectattr('type', 'equalto', 'vision')|first %}
                {% if vision %}
                <h3>{{ vision.title }}</h3>
                <p>{{ vision.content }}</p>
                {% else %}
                <p style="text-align: center; color: var(--text-light);">No vision found</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Team Tab -->
<div id="team-tab" class="tab-content">
    <div class="stats-grid">
        <div class="stat-card">
            <h3>{{ total_team_members }}</h3>
            <p>Total Members</p>
        </div>
        <div class="stat-card">
            <h3>{{ active_team_members }}</h3>
            <p>Active Members</p>
        </div>
    </div>

    <div class="filter-section">
        <div class="filter-controls">
            <input type="text" id="teamSearchInput" placeholder="Search team members..." onkeyup="filterTable('team')">
            <button class="btn-custom" onclick="openModal('team', 'add')">
                ‚ûï Add Team Member
            </button>
        </div>
    </div>

    <div class="content-table">
        <div class="table-header">
            <h2>Team Members</h2>
        </div>
        
        {% if team_members %}
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Role</th>
                        <th>Contributions</th>
                        <th>Order</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="teamTableBody">
                    {% for member in team_members %}
                    <tr data-id="{{ member.team_member_id }}" data-name="{{ member.name.lower() }}">
                        <td><strong>{{ member.name }}</strong></td>
                        <td>{{ member.role }}</td>
                        <td>{{ member.contributions|length }} items</td>
                        <td>{{ member.display_order }}</td>
                        <td>
                            {% if member.is_active %}
                                <span class="badge badge-success">Active</span>
                            {% else %}
                                <span class="badge badge-warning">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit" onclick="editTeamMember({{ member.team_member_id }})" title="Edit">‚úèÔ∏è</button>
                                <button class="btn-icon btn-toggle" onclick="toggleStatus('team', {{ member.team_member_id }}, {{ 'true' if member.is_active else 'false' }})" title="Toggle">
                                    {% if member.is_active %}üëÅÔ∏è{% else %}üö´{% endif %}
                                </button>
                                <button class="btn-icon btn-delete" onclick="deleteItem('team', {{ member.team_member_id }}, '{{ member.name }}')" title="Delete">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>No team members found</p>
            <button class="btn-custom" onclick="openModal('team', 'add')">Add Your First Team Member</button>
        </div>
        {% endif %}
    </div>
</div>

<!-- Values Tab -->
<div id="values-tab" class="tab-content">
    <div class="stats-grid">
        <div class="stat-card">
            <h3>{{ total_values }}</h3>
            <p>Total Values</p>
        </div>
        <div class="stat-card">
            <h3>{{ active_values }}</h3>
            <p>Active Values</p>
        </div>
    </div>

    <div class="filter-section">
        <div class="filter-controls">
            <input type="text" id="valuesSearchInput" placeholder="Search values..." onkeyup="filterTable('valuesTab')">
            <button class="btn-custom" onclick="openModal('valuesTab', 'add')">
                ‚ûï Add Value
            </button>
        </div>
    </div>

    <div class="content-table">
        <div class="table-header">
            <h2>Company Values</h2>
        </div>
        
        {% if values %}
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Order</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="valuesTableBody">
                    {% for value in values %}
                    <tr data-id="{{ value.value_id }}" data-title="{{ value.title.lower() }}">
                        <td><strong>{{ value.title }}</strong></td>
                        <td>{{ value.description[:80] }}...</td>
                        <td>{{ value.display_order }}</td>
                        <td>
                            {% if value.is_active %}
                                <span class="badge badge-success">Active</span>
                            {% else %}
                                <span class="badge badge-warning">Inactive</span>
                            {% endif %}
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-icon btn-edit" onclick="editValue({{ value.value_id }})" title="Edit">‚úèÔ∏è</button>
                                <button class="btn-icon btn-toggle" onclick="toggleStatus('valuesTab', {{ value.value_id }}, {{ 'true' if value.is_active else 'false' }})" title="Toggle">
                                    {% if value.is_active %}üëÅÔ∏è{% else %}üö´{% endif %}
                                </button>
                                <button class="btn-icon btn-delete" onclick="deleteItem('valuesTab', {{ value.value_id }}, '{{ value.title }}')" title="Delete">üóëÔ∏è</button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <p>No values found</p>
            <button class="btn-custom" onclick="openModal('valuesTab', 'add')">Add Your First Value</button>
        </div>
        {% endif %}
    </div>
</div>

<!-- Hero Feature Modal -->
<div id="heroModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="heroModalTitle">Add Hero Feature</h2>
            <button class="modal-close" onclick="closeModal('hero')">&times;</button>
        </div>
        
        <form id="heroForm" onsubmit="saveItem(event, 'hero')">
            <input type="hidden" id="heroId" name="hero_feature_id">
            
            <div class="form-group">
                <label for="heroTitle">Title*</label>
                <input type="text" id="heroTitle" name="title" required maxlength="200" 
                       placeholder="AI-Powered Face Recognition">
            </div>
            
            <div class="form-group">
                <label for="heroDescription">Short Description*</label>
                <input type="text" id="heroDescription" name="description" required maxlength="500" 
                       placeholder="99.8% accuracy for automatic attendance marking">
            </div>
            
            <div class="form-group">
                <label for="heroSummary">Summary*</label>
                <textarea id="heroSummary" name="summary" required 
                          placeholder="Detailed description shown in slideshow..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="heroIcon">Icon (Emoji)*</label>
                <input type="text" id="heroIcon" name="icon" required maxlength="10" 
                       placeholder="ü§ñ">
            </div>
            
            <div class="form-group">
                <label for="heroBgImage">Background Image URL*</label>
                <input type="text" id="heroBgImage" name="bg_image" required 
                       placeholder="https://images.unsplash.com/...">
                <small>Unsplash or other image URL</small>
            </div>
            
            <div class="form-group">
                <label for="heroDisplayOrder">Display Order*</label>
                <input type="number" id="heroDisplayOrder" name="display_order" required min="0" 
                       value="0" placeholder="0">
            </div>
            
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="heroIsActive" name="is_active" checked>
                    Active (visible to users)
                </label>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('hero')">Cancel</button>
                <button type="submit" class="btn-custom">
                    <span id="heroSubmitBtnText">Add Hero Feature</span>
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Stat Modal -->
<div id="statsModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="statsModalTitle">Add Stat</h2>
            <button class="modal-close" onclick="closeModal('stats')">&times;</button>
        </div>
        
        <form id="statsForm" onsubmit="saveItem(event, 'stats')">
            <input type="hidden" id="statId" name="stat_id">
            
            <div class="form-group">
                <label for="statValue">Value*</label>
                <input type="text" id="statValue" name="value" required maxlength="50" 
                       placeholder="500+">
                <small>E.g., "500+", "98%", "250K+"</small>
            </div>
            
            <div class="form-group">
                <label for="statLabel">Label*</label>
                <input type="text" id="statLabel" name="label" required maxlength="200" 
                       placeholder="Educational Institutions">
            </div>
            
            <div class="form-group">
                <label for="statDisplayOrder">Display Order*</label>
                <input type="number" id="statDisplayOrder" name="display_order" required min="0" 
                       value="0" placeholder="0">
            </div>
            
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="statIsActive" name="is_active" checked>
                    Active (visible to users)
                </label>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('stats')">Cancel</button>
                <button type="submit" class="btn-custom">
                    <span id="statsSubmitBtnText">Add Stat</span>
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Feature Modal -->
<div id="featuresModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="featuresModalTitle">Add Feature</h2>
            <button class="modal-close" onclick="closeModal('features')">&times;</button>
        </div>
        
        <form id="featuresForm" onsubmit="saveItem(event, 'features')">
            <input type="hidden" id="featureId" name="feature_id">
            
            <div class="form-group">
                <label for="slug">Slug (URL-friendly identifier)*</label>
                <input type="text" id="slug" name="slug" required pattern="[a-z0-9-]+" 
                       placeholder="ai-face-recognition">
            </div>
            
            <div class="form-group">
                <label for="icon">Icon (Emoji)*</label>
                <input type="text" id="icon" name="icon" required maxlength="10" 
                       placeholder="ü§ñ">
            </div>
            
            <div class="form-group">
                <label for="title">Title*</label>
                <input type="text" id="title" name="title" required maxlength="200" 
                       placeholder="AI-Powered Face Recognition">
            </div>
            
            <div class="form-group">
                <label for="description">Short Description*</label>
                <textarea id="description" name="description" required 
                          placeholder="Brief description shown on feature cards..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="details">Detailed Description (HTML supported)</label>
                <textarea id="details" name="details" rows="8" 
                          placeholder="<h4>Key Features:</h4><ul><li>Feature 1</li></ul>"></textarea>
            </div>
            
            <div class="form-group">
                <label for="tryUrl">Try URL</label>
                <input type="text" id="tryUrl" name="try_url" 
                       placeholder="/auth/register">
            </div>
            
            <div class="form-group">
                <label for="displayOrder">Display Order*</label>
                <input type="number" id="displayOrder" name="display_order" required min="0" 
                       value="0" placeholder="0">
            </div>
            
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="isActive" name="is_active" checked>
                    Active
                </label>
                <label>
                    <input type="checkbox" id="isAdvanced" name="is_advanced">
                    Advanced Feature
                </label>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('features')">Cancel</button>
                <button type="submit" class="btn-custom">
                    <span id="featuresSubmitBtnText">Add Feature</span>
                </button>
            </div>
        </form>
    </div>
</div>

<!-- About Intro Modal -->
<div id="aboutIntroModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Edit About Intro</h2>
            <button class="modal-close" onclick="closeModal('aboutIntro')">&times;</button>
        </div>
        <form id="aboutIntroForm" onsubmit="saveAboutIntro(event)">
            <div class="form-group">
                <label for="introTitle">Title*</label>
                <input type="text" id="introTitle" name="title" required maxlength="200">
            </div>
            <div class="form-group">
                <label for="introDescription">Description*</label>
                <textarea id="introDescription" name="description" required rows="4"></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('aboutIntro')">Cancel</button>
                <button type="submit" class="btn-custom">Update</button>
            </div>
        </form>
    </div>
</div>

<!-- About Story Modal -->
<div id="aboutStoryModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Edit Our Story</h2>
            <button class="modal-close" onclick="closeModal('aboutStory')">&times;</button>
        </div>
        <form id="aboutStoryForm" onsubmit="saveAboutStory(event)">
            <div class="form-group">
                <label for="storyTitle">Title*</label>
                <input type="text" id="storyTitle" name="title" required maxlength="200">
            </div>
            <div class="form-group">
                <label for="storyContent">Content*</label>
                <textarea id="storyContent" name="content" required rows="6"></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('aboutStory')">Cancel</button>
                <button type="submit" class="btn-custom">Update</button>
            </div>
        </form>
    </div>
</div>

<!-- Mission/Vision Modal -->
<div id="missionVisionModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="missionVisionModalTitle">Edit Mission/Vision</h2>
            <button class="modal-close" onclick="closeModal('missionVision')">&times;</button>
        </div>
        <form id="missionVisionForm" onsubmit="saveMissionVision(event)">
            <input type="hidden" id="mvType" name="type">
            <div class="form-group">
                <label for="mvTitle">Title*</label>
                <input type="text" id="mvTitle" name="title" required maxlength="200">
            </div>
            <div class="form-group">
                <label for="mvContent">Content*</label>
                <textarea id="mvContent" name="content" required rows="6"></textarea>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('missionVision')">Cancel</button>
                <button type="submit" class="btn-custom">Update</button>
            </div>
        </form>
    </div>
</div>

<!-- Team Member Modal -->
<div id="teamModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="teamModalTitle">Add Team Member</h2>
            <button class="modal-close" onclick="closeModal('team')">&times;</button>
        </div>
        <form id="teamForm" onsubmit="saveItem(event, 'team')">
            <input type="hidden" id="teamMemberId" name="team_member_id">
            <div class="form-group">
                <label for="teamName">Name*</label>
                <input type="text" id="teamName" name="name" required maxlength="200">
            </div>
            <div class="form-group">
                <label for="teamRole">Role*</label>
                <input type="text" id="teamRole" name="role" required maxlength="200">
            </div>
            <div class="form-group">
                <label for="teamDescription">Description*</label>
                <textarea id="teamDescription" name="description" required rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="teamContributions">Contributions (one per line)*</label>
                <textarea id="teamContributions" name="contributions" required rows="6" placeholder="Line 1&#10;Line 2&#10;Line 3"></textarea>
                <small>Enter each contribution on a new line</small>
            </div>
            <div class="form-group">
                <label for="teamSkills">Skills (one per line)*</label>
                <textarea id="teamSkills" name="skills" required rows="4" placeholder="Skill 1&#10;Skill 2&#10;Skill 3"></textarea>
                <small>Enter each skill on a new line</small>
            </div>
            <div class="form-group">
                <label for="teamDisplayOrder">Display Order*</label>
                <input type="number" id="teamDisplayOrder" name="display_order" required min="0" value="0">
            </div>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="teamIsActive" name="is_active" checked>
                    Active
                </label>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('team')">Cancel</button>
                <button type="submit" class="btn-custom">
                    <span id="teamSubmitBtnText">Add Team Member</span>
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Value Modal -->
<div id="valuesTabModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="valuesTabModalTitle">Add Value</h2>
            <button class="modal-close" onclick="closeModal('valuesTab')">&times;</button>
        </div>
        <form id="valuesTabForm" onsubmit="saveItem(event, 'valuesTab')">
            <input type="hidden" id="valueId" name="value_id">
            <div class="form-group">
                <label for="valueTitle">Title*</label>
                <input type="text" id="valueTitle" name="title" required maxlength="200">
            </div>
            <div class="form-group">
                <label for="valueDescription">Description*</label>
                <textarea id="valueDescription" name="description" required rows="4"></textarea>
            </div>
            <div class="form-group">
                <label for="valueDisplayOrder">Display Order*</label>
                <input type="number" id="valueDisplayOrder" name="display_order" required min="0" value="0">
            </div>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="valueIsActive" name="is_active" checked>
                    Active
                </label>
            </div>
            <div class="modal-actions">
                <button type="button" class="btn-custom btn-outline-custom" onclick="closeModal('valuesTab')">Cancel</button>
                <button type="submit" class="btn-custom">
                    <span id="valuesTabSubmitBtnText">Add Value</span>
                </button>
            </div>
        </form>
    </div>
</div>

<script>
// Data from backend
const heroFeaturesData = {{ hero_features|tojson|safe }};
const statsData = {{ stats|tojson|safe }};
const featuresData = {{ features|tojson|safe }};
const aboutIntroData = {{ about_intro|tojson|safe }};
const aboutStoryData = {{ about_story|tojson|safe }};
const missionVisionData = {{ mission_vision|tojson|safe }};
let teamMembersData = {{ team_members|tojson|safe }};
let valuesData = {{ values|tojson|safe }};

function switchTab(tab) {
    // Update tab buttons
    document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
    event.target.classList.add('active');
    
    // Update tab content
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    document.getElementById(`${tab}-tab`).classList.add('active');
}

function openModal(type, mode, itemId = null) {
    const modal = document.getElementById(`${type}Modal`);
    const form = document.getElementById(`${type}Form`);
    form.reset();
    
    if (mode === 'add') {
        document.getElementById(`${type}ModalTitle`).textContent = `Add ${type === 'hero' ? 'Hero Feature' : type === 'stats' ? 'Stat' : 'Feature'}`;
        document.getElementById(`${type}SubmitBtnText`).textContent = `Add ${type === 'hero' ? 'Hero Feature' : type === 'stats' ? 'Stat' : 'Feature'}`;
        
        // Set defaults
        if (type === 'hero') {
            document.getElementById('heroIsActive').checked = true;
        } else if (type === 'stats') {
            document.getElementById('statIsActive').checked = true;
        } else {
            document.getElementById('isActive').checked = true;
        }
    }
    
    modal.classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeModal(type) {
    document.getElementById(`${type}Modal`).classList.remove('active');
    document.body.style.overflow = 'auto';
}

function editHeroFeature(id) {
    const item = heroFeaturesData.find(hf => hf.hero_feature_id === id);
    if (item) {
        document.getElementById('heroModalTitle').textContent = 'Edit Hero Feature';
        document.getElementById('heroSubmitBtnText').textContent = 'Update Hero Feature';
        document.getElementById('heroId').value = item.hero_feature_id;
        document.getElementById('heroTitle').value = item.title;
        document.getElementById('heroDescription').value = item.description;
        document.getElementById('heroSummary').value = item.summary;
        document.getElementById('heroIcon').value = item.icon;
        document.getElementById('heroBgImage').value = item.bg_image;
        document.getElementById('heroDisplayOrder').value = item.display_order;
        document.getElementById('heroIsActive').checked = item.is_active;
        
        document.getElementById('heroModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

function editStat(id) {
    const item = statsData.find(s => s.stat_id === id);
    if (item) {
        document.getElementById('statsModalTitle').textContent = 'Edit Stat';
        document.getElementById('statsSubmitBtnText').textContent = 'Update Stat';
        document.getElementById('statId').value = item.stat_id;
        document.getElementById('statValue').value = item.value;
        document.getElementById('statLabel').value = item.label;
        document.getElementById('statDisplayOrder').value = item.display_order;
        document.getElementById('statIsActive').checked = item.is_active;
        
        document.getElementById('statsModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

function editFeature(id) {
    const item = featuresData.find(f => f.feature_id === id);
    if (item) {
        document.getElementById('featuresModalTitle').textContent = 'Edit Feature';
        document.getElementById('featuresSubmitBtnText').textContent = 'Update Feature';
        document.getElementById('featureId').value = item.feature_id;
        document.getElementById('slug').value = item.slug;
        document.getElementById('icon').value = item.icon;
        document.getElementById('title').value = item.title;
        document.getElementById('description').value = item.description;
        document.getElementById('details').value = item.details || '';
        document.getElementById('tryUrl').value = item.try_url || '';
        document.getElementById('displayOrder').value = item.display_order;
        document.getElementById('isActive').checked = item.is_active;
        document.getElementById('isAdvanced').checked = item.is_advanced;
        
        document.getElementById('featuresModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }
}

async function saveItem(event, type) {
    event.preventDefault();
    const formData = new FormData(event.target);
    
    let data, url, idField;
    
    if (type === 'hero') {
        idField = 'hero_feature_id';
        data = {
            hero_feature_id: formData.get(idField) || null,
            title: formData.get('title'),
            description: formData.get('description'),
            summary: formData.get('summary'),
            icon: formData.get('icon'),
            bg_image: formData.get('bg_image'),
            display_order: parseInt(formData.get('display_order')),
            is_active: document.getElementById('heroIsActive').checked
        };
        url = data.hero_feature_id 
            ? `/platform/api/hero-features/${data.hero_feature_id}/update`
            : '/platform/api/hero-features/create';
    } else if (type === 'stats') {
        idField = 'stat_id';
        data = {
            stat_id: formData.get(idField) || null,
            value: formData.get('value'),
            label: formData.get('label'),
            display_order: parseInt(formData.get('display_order')),
            is_active: document.getElementById('statIsActive').checked
        };
        url = data.stat_id 
            ? `/platform/api/stats/${data.stat_id}/update`
            : '/platform/api/stats/create';
    } else {
        idField = 'feature_id';
        data = {
            feature_id: formData.get(idField) || null,
            slug: formData.get('slug'),
            icon: formData.get('icon'),
            title: formData.get('title'),
            description: formData.get('description'),
            details: formData.get('details'),
            try_url: formData.get('try_url'),
            display_order: parseInt(formData.get('display_order')),
            is_active: document.getElementById('isActive').checked,
            is_advanced: document.getElementById('isAdvanced').checked
        };
        url = data.feature_id 
            ? `/platform/api/features/${data.feature_id}/update`
            : '/platform/api/features/create';
    }
    
    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.success) {
            alert(result.message || 'Saved successfully!');
            window.location.reload();
        } else {
            alert(result.error || 'Failed to save');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while saving');
    }
}

async function toggleStatus(type, id, currentStatus) {
    const newStatus = !currentStatus;
    let url;
    
    if (type === 'hero') {
        url = `/platform/api/hero-features/${id}/toggle-status`;
    } else if (type === 'stats') {
        url = `/platform/api/stats/${id}/toggle-status`;
    } else {
        url = `/platform/api/features/${id}/toggle-status`;
    }
    
    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ is_active: newStatus })
        });
        
        const result = await response.json();
        
        if (result.success) {
            window.location.reload();
        } else {
            alert(result.error || 'Failed to toggle status');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('An error occurred');
    }
}

async function deleteItem(type, id, name) {
    if (!confirm(`Delete "${name}"?`)) return;
    
    let url;
    if (type === 'hero') {
        url = `/platform/api/hero-features/${id}/delete`;
    } else if (type === 'stats') {
        url = `/platform/api/stats/${id}/delete`;
    } else {
        url = `/platform/api/features/${id}/delete`;
    }
    
    try {
        const response = await fetch(url, { method: 'POST' });
        const result = await response.json();
        
        if (result.success) {
            alert('Deleted successfully!');
            window.location.reload();
        } else {
            alert(result.error || 'Failed to delete');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('An error occurred');
    }
}

function filterTable(type) {
    let rows, searchTerm;
    
    if (type === 'hero') {
        rows = document.querySelectorAll('#heroTableBody tr');
        searchTerm = document.getElementById('heroSearchInput').value.toLowerCase();
        rows.forEach(row => {
            const title = row.dataset.title;
            row.style.display = title.includes(searchTerm) ? '' : 'none';
        });
    } else if (type === 'stats') {
        rows = document.querySelectorAll('#statsTableBody tr');
        searchTerm = document.getElementById('statsSearchInput').value.toLowerCase();
        rows.forEach(row => {
            const label = row.dataset.label;
            row.style.display = label.includes(searchTerm) ? '' : 'none';
        });
    } else {
        rows = document.querySelectorAll('#featuresTableBody tr');
        const status = document.getElementById('statusFilter').value;
        const typeFilter = document.getElementById('typeFilter').value;
        searchTerm = document.getElementById('featuresSearchInput').value.toLowerCase();
        
        rows.forEach(row => {
            const rowStatus = row.dataset.status;
            const rowType = row.dataset.type;
            const title = row.dataset.title;
            
            const statusMatch = !status || rowStatus === status;
            const typeMatch = !typeFilter || rowType === typeFilter;
            const searchMatch = !searchTerm || title.includes(searchTerm);
            
            row.style.display = (statusMatch && typeMatch && searchMatch) ? '' : 'none';
        });
    }
}

// About Us Section Functions
function editAboutIntro() {
    if (aboutIntroData) {
        document.getElementById('introTitle').value = aboutIntroData.title || '';
        document.getElementById('introDescription').value = aboutIntroData.description || '';
    }
    document.getElementById('aboutIntroModal').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function editAboutStory() {
    if (aboutStoryData) {
        document.getElementById('storyTitle').value = aboutStoryData.title || '';
        document.getElementById('storyContent').value = aboutStoryData.content || '';
    }
    document.getElementById('aboutStoryModal').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function editMissionVision(type) {
    const item = missionVisionData.find(mv => mv.type === type);
    document.getElementById('missionVisionModalTitle').textContent = `Edit ${type.charAt(0).toUpperCase() + type.slice(1)}`;
    document.getElementById('mvType').value = type;
    
    if (item) {
        document.getElementById('mvTitle').value = item.title || '';
        document.getElementById('mvContent').value = item.content || '';
    } else {
        document.getElementById('mvTitle').value = '';
        document.getElementById('mvContent').value = '';
    }
    
    document.getElementById('missionVisionModal').classList.add('active');
    document.body.style.overflow = 'hidden';
}

async function saveAboutIntro(event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    
    const data = {
        title: formData.get('title'),
        description: formData.get('description')
    };
    
    try {
        const response = await fetch('/platform/api/about-intro/update', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.success) {
            closeModal('aboutIntro');
            window.location.reload();
        } else {
            alert(result.message || 'Failed to update intro');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while saving');
    }
}

async function saveAboutStory(event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    
    const data = {
        title: formData.get('title'),
        content: formData.get('content')
    };
    
    try {
        const response = await fetch('/platform/api/about-story/update', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.success) {
            closeModal('aboutStory');
            window.location.reload();
        } else {
            alert(result.message || 'Failed to update story');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while saving');
    }
}

async function saveMissionVision(event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    
    const data = {
        type: formData.get('type'),
        title: formData.get('title'),
        content: formData.get('content')
    };
    
    try {
        const response = await fetch('/platform/api/mission-vision/update', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        
        const result = await response.json();
        
        if (result.success) {
            closeModal('missionVision');
            window.location.reload();
        } else {
            alert(result.message || 'Failed to update mission/vision');
        }
    } catch (error) {
        console.error('Error:', error);
        alert('An error occurred while saving');
    }
}

// Close modals on click outside
['heroModal', 'statsModal', 'featuresModal', 'aboutIntroModal', 'aboutStoryModal', 'missionVisionModal'].forEach(modalId => {
    document.getElementById(modalId).addEventListener('click', function(e) {
        if (e.target === this) {
            closeModal(modalId.replace('Modal', ''));
        }
    });
});

// Close modals with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        ['hero', 'stats', 'features', 'aboutIntro', 'aboutStory', 'missionVision'].forEach(type => closeModal(type));
    }
});
</script>

{% endblock %}
