{% extends "layouts/base.html" %}

{% block title %}{{ testimonial.author_name }} - AttendAI Testimonial{% endblock %}

{% block content %}
<style>
    /* Page Header */
    .page-header {
        margin-bottom: 2rem;
        padding: 2rem 0;
        border-bottom: 1px solid var(--border-soft);
        max-width: 900px;
    }

    .back-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        color: var(--text-light);
        text-decoration: none;
        font-weight: 400;
        font-size: 0.95rem;
        margin-bottom: 1.5rem;
        transition: color 0.2s ease, border-color 0.2s ease;
        border-bottom: 1px solid transparent;
    }

    .back-link:hover {
        color: var(--text-dark);
        text-decoration: none;
        border-bottom-color: var(--text-dark);
    }

    .back-arrow {
        font-size: 1rem;
    }

    .testimonial-title {
        font-size: 2.5rem;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 0;
        font-style: italic;
        line-height: 1.35;
    }

    /* Author Section */
    .author-section {
        display: flex;
        align-items: center;
        gap: 1.5rem;
        margin-bottom: 2rem;
        padding: 1.5rem 2rem;
        background-color: #fff;
        border-radius: 16px;
        border: 1px solid var(--border-soft);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    }

    .author-avatar,
    .author-avatar-placeholder {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        object-fit: cover;
        border: 1px solid var(--border-soft);
        flex-shrink: 0;
    }

    .author-avatar-placeholder {
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.25rem;
        font-weight: 600;
        color: var(--text-light);
        background-color: #f8fafc;
    }

    .author-info {
        flex: 1;
    }

    .author-name {
        font-weight: 600;
        color: var(--text-dark);
        font-size: 1.25rem;
        margin-bottom: 0.35rem;
    }

    .author-title {
        color: var(--text-light);
        font-size: 1rem;
        margin-bottom: 0.25rem;
    }

    .author-organization {
        color: var(--text-light);
        font-size: 1rem;
        font-weight: 500;
    }

    /* Ratings */
    .testimonial-rating {
        display: flex;
        gap: 0.25rem;
        margin-top: 0.5rem;
    }

    .star {
        color: #fbbf24;
        font-size: 1.5rem;
    }

    /* Testimonial Content */
    .testimonial-content {
        line-height: 1.75;
        color: var(--text-dark);
        margin: 2.5rem 0;
        word-wrap: break-word;
        overflow-wrap: break-word;
        word-break: break-word;
        max-width: 100%;
        padding-top: 2rem;
        border-top: 1px solid var(--border-soft);
    }

    .testimonial-content p {
        margin-bottom: 1.25rem;
        text-align: justify;
        font-size: 1.05rem;
        word-wrap: break-word;
        overflow-wrap: break-word;
        word-break: break-word;
    }

    .testimonial-content p:first-child::first-letter {
        font-size: 2.5rem;
        font-weight: 600;
        float: left;
        line-height: 1;
        margin: 0.08em 0.08em 0 0;
        color: var(--text-dark);
        opacity: 0.9;
    }

    /* Key Results Section */
    .results-section {
        background-color: #fff;
        border: 1px solid var(--border-soft);
        border-radius: 16px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
        padding: 2.5rem;
        margin: 3rem 0;
    }

    .results-section h3 {
        font-size: 1.75rem;
        color: var(--text-dark);
        margin-bottom: 1.5rem;
        font-weight: bold;
        text-align: center;
    }

    .results-grid {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 2rem;
    }

    .result-item {
        text-align: center;
        padding: 1.5rem;
        background-color: #fff;
        border-radius: 12px;
        border: 1px solid var(--border-soft);
    }

    .result-value {
        font-size: 2rem;
        font-weight: bold;
        color: var(--text-dark);
        margin-bottom: 0.5rem;
    }

    .result-label {
        color: var(--text-light);
        font-size: 0.95rem;
    }

    /* Gallery Section */
    .gallery-section {
        margin: 3rem 0;
    }

    .gallery-section h3 {
        font-size: 1.75rem;
        color: var(--text-dark);
        margin-bottom: 1.5rem;
        font-weight: bold;
    }

    .gallery-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 1.5rem;
    }

    .gallery-item {
        height: 200px;
        border: 1px solid var(--border-soft);
        border-radius: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #fff;
        color: var(--text-light);
        font-size: 1rem;
        transition: transform 0.3s ease;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    }

    .gallery-item:hover {
        transform: translateY(-3px);
    }

    /* Related Testimonials */
    .related-section {
        margin: 4rem 0;
        padding-top: 3rem;
        border-top: 1px solid var(--border-soft);
    }

    .related-section h3 {
        font-size: 1.75rem;
        color: var(--text-dark);
        margin-bottom: 2rem;
        font-weight: bold;
        text-align: center;
    }

    .related-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 2rem;
    }

    .related-card {
        border: 1px solid var(--border-soft);
        border-radius: 16px;
        padding: 1.5rem;
        background-color: #fff;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
        transition: all 0.3s ease;
        text-decoration: none;
        display: flex;
        flex-direction: column;
        color: inherit;
    }

    .related-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        text-decoration: none;
        color: inherit;
    }

    .related-author {
        font-weight: 600;
        color: var(--text-dark);
        font-size: 1.05rem;
        margin-bottom: 0.5rem;
    }

    .related-excerpt {
        color: var(--text-dark);
        font-size: 0.95rem;
        line-height: 1.55;
        margin-bottom: 1rem;
        flex: 1;
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .related-card .read-more-link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-top: auto;
        padding: 0.5rem 1.25rem;
        min-height: 2.5rem;
        font-size: 0.9rem;
        font-weight: 600;
        color: #0b1220;
        background: #fff;
        border: 2px solid var(--border-soft);
        border-radius: 50px;
        text-decoration: none;
        transition: all 0.3s ease;
        width: fit-content;
    }

    .related-card:hover .read-more-link {
        background-color: var(--primary-dark);
        color: #fff;
        border-color: var(--primary-dark);
        text-decoration: none;
    }

    /* CTA Section */
    .cta-section {
        text-align: center;
        margin: 4rem 0;
        padding: 3rem;
        background-color: #fff;
        border-radius: 16px;
        border: 1px solid var(--border-soft);
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
    }

    .cta-section h3 {
        font-size: 2rem;
        color: var(--text-dark);
        margin-bottom: 1rem;
        font-weight: bold;
    }

    .cta-section p {
        font-size: 1.1rem;
        color: var(--text-light);
        margin-bottom: 2rem;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
    }

    .cta-buttons {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 1rem;
    }

    /* Responsive */
    @media (max-width: 1024px) {
        .results-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .gallery-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .related-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (max-width: 768px) {
        .testimonial-title {
            font-size: 2rem;
        }

        .page-header {
            max-width: 100%;
        }

        .author-section {
            flex-direction: column;
            text-align: center;
            padding: 1.5rem;
        }

        .author-avatar,
        .author-avatar-placeholder {
            width: 72px;
            height: 72px;
            font-size: 1.1rem;
        }

        .results-grid {
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .gallery-grid {
            grid-template-columns: 1fr;
        }

        .related-grid {
            grid-template-columns: 1fr;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-section {
            padding: 2rem 1.5rem;
        }
    }

    @media (max-width: 480px) {
        .testimonial-title {
            font-size: 1.75rem;
        }

        .author-name {
            font-size: 1.25rem;
        }

        .testimonial-content p {
            font-size: 1rem;
        }

        .result-item {
            padding: 1rem;
        }

        .result-value {
            font-size: 1.5rem;
        }
    }
</style>

<!-- Back Link -->
<a href="{{ url_for('main.testimonials') }}" class="back-link">
    <span class="back-arrow">←</span> Back to All Testimonials
</a>

<!-- Page Header -->
<div class="page-header">
    <h1 class="testimonial-title">"How AttendAI Transformed Our University's Attendance Tracking"</h1>
</div>

<!-- Author Section -->
<div class="author-section">
    <div class="author-avatar-placeholder">
        {{ testimonial.user_name[:2]|upper }}
    </div>
    <div class="author-info">
        <div class="author-name">{{ testimonial.user_name }}</div>
        <div class="author-title">{{ testimonial.user_role|title }} at {{ testimonial.institution_name }}</div>
        <div class="testimonial-rating">
            {% for i in range(testimonial.rating) %}
            <span class="star">★</span>
            {% endfor %}
            {% for i in range(5 - testimonial.rating) %}
            <span class="star" style="color: #e5e7eb;">★</span>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Testimonial Content -->
<div class="testimonial-content">
    <p>{{ testimonial.content | safe }}</p>
</div>


<!-- Related Testimonials -->
<div class="related-section">
    <h3>More Success Stories</h3>
    <div class="related-grid">
        {% if related_testimonials and related_testimonials|length > 0 %}
            {% for related in related_testimonials %}
            <a href="{{ url_for('main.testimonial_detail', testimonial_id=related.id) }}" class="related-card">
                <div class="testimonial-rating" style="margin-bottom: 0.75rem;">
                    {% for i in range(related.rating) %}
                    <span class="star">★</span>
                    {% endfor %}
                    {% for i in range(5 - related.rating) %}
                    <span class="star" style="color: #e5e7eb;">★</span>
                    {% endfor %}
                </div>
                <div class="related-author">{{ related.user_name }}</div>
                <div style="color: var(--text-light); font-size: 0.85rem; margin-bottom: 0.75rem;">{{ related.user_role|title }} at {{ related.institution_name }}</div>
                <div class="related-excerpt">"{{ related.summary or related.content[:150] + '...' }}"</div>
                <span class="read-more-link">Read Full Story →</span>
            </a>
            {% endfor %}
        {% else %}
            <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                <p style="color: var(--text-light);">No other testimonials available at the moment.</p>
            </div>
        {% endif %}
    </div>
</div>

<!-- CTA Section -->
<div class="cta-section">
    <h3>Ready to Transform Your Attendance Management?</h3>
    <p>Like {{ testimonial.institution_name }}, you can achieve significant improvements in efficiency, accuracy, and student outcomes with AttendAI. Register now and experience the difference.</p>
    <div class="cta-buttons">
    {% if not session.user %}
        <a class="btn-primary" href="{{ url_for('auth.register') }}">Register With Us</a>
        <a class="btn-outline" href="{{ url_for('main.subscriptions') }}">View Pricing</a>
    {% else %}
        <a class="btn-outline" href="{{ url_for('main.features') }}">Explore Features</a>
    {% endif %}
    </div>
</div>
{% endblock %}